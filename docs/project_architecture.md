# Проектирование архитектуры системы

## 1. Схема бизнес-процессов предметной области (методология Aris)

### 1.1 Организационная структура (Organizational Chart)

![Организационная структура](./images/org_chart.png)

**Описание организационной структуры:**

В организационной структуре компании, внедряющей Magento 2 с системой мониторинга, выделяются следующие ключевые элементы:

1. **Руководство компании**
   - Генеральный директор
   - Финансовый директор
   - Коммерческий директор

2. **ИТ-департамент**
   - Директор по ИТ
     - Отдел разработки
       - Руководитель отдела разработки
       - Backend-разработчики (Magento)
       - Frontend-разработчики
       - DevOps-инженеры
     - Отдел поддержки
       - Руководитель отдела поддержки
       - Системные администраторы
       - Специалисты технической поддержки
     - Отдел тестирования и QA
       - Руководитель отдела тестирования
       - QA-инженеры
       - Тестировщики

3. **Коммерческий департамент**
   - Отдел продаж
   - Отдел маркетинга
   - Отдел обслуживания клиентов

4. **Складской и логистический департаменты**
   - Отдел логистики
   - Отдел складского учета

Ответственность за внедрение и эксплуатацию системы мониторинга Magento 2 распределяется следующим образом:
- **DevOps-инженеры** - настройка и обслуживание системы мониторинга
- **Системные администраторы** - контроль функционирования и реагирование на уведомления
- **Backend-разработчики** - разработка и доработка модулей системы
- **Руководитель отдела поддержки** - координация работы по устранению инцидентов

### 1.2 Карта процессов (Process Landscape)

![Карта процессов](./images/process_landscape.png)

**Описание карты процессов:**

Карта процессов показывает иерархию бизнес-процессов компании, которые поддерживаются системой Magento 2 и системой мониторинга:

1. **Основные процессы**
   - **Управление каталогом**
     - Создание и обновление товаров
     - Управление категориями
     - Импорт/экспорт товаров
   - **Обработка заказов**
     - Оформление заказа
     - Обработка платежей
     - Управление статусами заказов
   - **Логистика и доставка**
     - Управление складом
     - Организация доставки
     - Отслеживание отправлений

2. **Поддерживающие процессы**
   - **Мониторинг и поддержка системы**
     - Мониторинг Cron-задач
     - Мониторинг очередей сообщений (RabbitMQ)
     - Мониторинг индексации
     - Оповещение о сбоях
   - **Техническое обслуживание**
     - Обновление системы
     - Резервное копирование
     - Оптимизация производительности
   - **Управление пользователями**
     - Администрирование доступа
     - Управление ролями
     - Аудит действий пользователей

3. **Управленческие процессы**
   - **Стратегическое планирование**
   - **Управление ресурсами**
   - **Анализ эффективности**

Система мониторинга Magento 2 непосредственно взаимодействует с поддерживающими процессами и оказывает влияние на качество выполнения основных бизнес-процессов.

### 1.3 Диаграмма BPMN (Business Process Model and Notation)

![Диаграмма BPMN](./images/bpmn_diagram.png)

**Описание диаграммы BPMN:**

Диаграмма BPMN отображает процесс обнаружения и устранения проблем с использованием системы мониторинга Magento 2:

1. **Участники процесса:**
   - Система мониторинга
   - Системный администратор
   - DevOps-инженер
   - Разработчик
   - Руководитель отдела

2. **Основные этапы процесса:**
   - **Начальное событие:** Возникновение потенциальной проблемы (сбой Cron-задачи, застревание очереди сообщений)
   - **Подпроцесс мониторинга:** Система мониторинга обнаруживает проблему
   - **Шлюз:** Определение критичности проблемы
   - **Задачи:**
     - Отправка уведомления в Telegram
     - Анализ проблемы системным администратором
     - Эскалация проблемы (при необходимости)
     - Устранение проблемы
   - **Конечное событие:** Восстановление нормальной работы системы

3. **Параллельные процессы:**
   - Логирование информации о проблеме
   - Информирование руководителя при критичных проблемах

### 1.4 Диаграмма EPC (Event-driven Process Chain)

![Диаграмма EPC](./images/epc_diagram.png)

**Описание диаграммы EPC:**

Диаграмма EPC моделирует последовательность событий и функций в процессе мониторинга Cron-задач в Magento 2:

1. **События:**
   - Запуск Cron-задачи
   - Завершение выполнения Cron-задачи
   - Обнаружение "застрявшей" Cron-задачи
   - Превышение лимита времени выполнения
   - Успешное устранение проблемы

2. **Функции:**
   - Регистрация запуска задачи
   - Мониторинг выполнения
   - Анализ статуса задачи
   - Формирование уведомления
   - Обработка инцидента
   - Перезапуск задачи

3. **Роли и организационные единицы:**
   - Система мониторинга Magento
   - Системный администратор
   - DevOps-инженер

4. **Информационные системы:**
   - База данных Magento
   - Сервис RabbitMQ
   - Telegram API

### 1.5 Карта систем (System landscape)

![Карта систем](./images/system_landscape.png)

**Описание карты систем:**

Карта систем показывает информационно-технологические решения, используемые в организации:

1. **Основные системы:**
   - **Magento 2** - основная платформа электронной коммерции
   - **Система мониторинга** - набор модулей Lachestry для мониторинга Magento
   - **CRM-система** - управление взаимоотношениями с клиентами
   - **ERP-система** - управление ресурсами предприятия
   - **WMS** - система управления складом

2. **Вспомогательные системы:**
   - **Система аналитики** - анализ данных о продажах и клиентах
   - **Система управления контентом** - управление контентом сайта
   - **Система резервного копирования**
   - **Система управления доступом**

3. **Интеграции:**
   - Интеграция Magento с ERP-системой
   - Интеграция Magento с WMS
   - Интеграция системы мониторинга с Telegram
   - Интеграция с платежными системами

Система мониторинга Magento 2 взаимодействует с основной платформой Magento, сервисами RabbitMQ и MySQL, а также с внешним сервисом Telegram для отправки уведомлений.

### 1.6 ИT-инфраструктура (IT-infrastructure)

![ИT-инфраструктура](./images/it_infrastructure.png)

**Описание ИT-инфраструктуры:**

ИT-инфраструктура представляет технические решения, используемые для работы системы Magento 2 с модулями мониторинга:

1. **Программное обеспечение:**
   - **Серверное ПО:**
     - Операционная система: Linux (Ubuntu/CentOS)
     - Веб-сервер: Nginx
     - PHP-FPM: PHP 7.4/8.x
     - База данных: MySQL 5.7
     - Сервис очередей: RabbitMQ
     - Поисковый движок: Elasticsearch 7.x
     - Система кэширования: Redis
   - **Клиентское ПО:**
     - Браузеры: Chrome, Firefox, Safari
     - Мобильные приложения
     - Telegram-клиент (для получения уведомлений)

2. **Аппаратное обеспечение:**
   - **Серверы:**
     - Веб-серверы (2+ для высокой доступности)
     - Серверы базы данных (master + slave)
     - Сервер очередей (RabbitMQ)
     - Сервер Elasticsearch
     - Сервер Redis
   - **Сетевое оборудование:**
     - Маршрутизаторы
     - Коммутаторы
     - Балансировщики нагрузки
     - Брандмауэры

3. **Сетевая инфраструктура:**
   - Внутренняя сеть (LAN)
   - Демилитаризованная зона (DMZ) для публичных сервисов
   - VPN для удаленного доступа
   - Внешнее подключение к Интернет

### 1.7 Модель данных (Data model)

![Модель данных](./images/data_model.png)

**Описание модели данных:**

#### 1.7.1 Концептуальная (инфологическая) модель

На концептуальном уровне модель данных системы мониторинга Magento 2 включает следующие сущности:

1. **CronJob** - информация о Cron-задачах
2. **TelegramChat** - информация о Telegram-чатах для отправки уведомлений
3. **RabbitMQConsumer** - информация о потребителях сообщений RabbitMQ
4. **Notification** - уведомления о событиях и проблемах
5. **Module** - модули Magento, связанные с Cron-задачами
6. **User** - пользователи системы

Связи между сущностями:
- CronJob связан с Module (многие к одному)
- Notification связан с CronJob (многие к одному)
- Notification связан с RabbitMQConsumer (многие к одному)
- Notification связан с TelegramChat (многие ко многим)
- User связан с TelegramChat (многие к одному)

#### 1.7.2 Даталогическая модель

На даталогическом уровне модель уточняется и включает следующие таблицы:

1. **lachestry_job_codes_info**
   - id (PK)
   - job_code_name
   - schedule
   - module
   - config_path
   - group

2. **lachestry_telegram_chats**
   - id (PK)
   - chat_id
   - chat_name
   - user_name
   - created_at
   - telegram_updated_at
   - is_active

3. **rabbitmq_consumer_activity**
   - entity_id (PK)
   - consumer_name
   - pid
   - last_activity
   - status

4. **notification_log**
   - id (PK)
   - type
   - message
   - severity
   - created_at
   - source_type
   - source_id
   - is_sent

5. **notification_recipient**
   - notification_id (PK, FK)
   - chat_id (PK, FK)
   - sent_at
   - is_read

#### 1.7.3 Физическая модель

На физическом уровне определяются типы данных, индексы, ограничения:

```sql
CREATE TABLE `lachestry_job_codes_info` (
  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `job_code_name` varchar(100) NOT NULL COMMENT 'Job code',
  `schedule` varchar(50) DEFAULT NULL COMMENT 'job schedule',
  `module` varchar(150) DEFAULT NULL COMMENT 'module',
  `config_path` varchar(200) DEFAULT NULL COMMENT 'config path',
  `group` varchar(100) DEFAULT NULL COMMENT 'cron group',
  PRIMARY KEY (`id`),
  UNIQUE KEY `LACHESTRY_JOB_CODES_INFO_JOB_CODE_NAME` (`job_code_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Cron Job Codes Information';

CREATE TABLE `lachestry_telegram_chats` (
  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `chat_id` bigint(20) NOT NULL COMMENT 'TG chat id',
  `chat_name` varchar(60) DEFAULT NULL COMMENT 'chat name',
  `user_name` varchar(40) DEFAULT NULL COMMENT 'TG user name',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation Time',
  `telegram_updated_at` timestamp NULL DEFAULT NULL COMMENT 'Telegram Updated At',
  `is_active` smallint(6) DEFAULT NULL COMMENT 'Is Active',
  PRIMARY KEY (`id`),
  UNIQUE KEY `LACHESTRY_TELEGRAM_CHATS_CHAT_ID` (`chat_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Telegram Chats';

CREATE TABLE `rabbitmq_consumer_activity` (
  `entity_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `consumer_name` varchar(255) NOT NULL COMMENT 'Consumer Name',
  `pid` int(10) unsigned DEFAULT NULL COMMENT 'Process ID',
  `last_activity` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last Activity Time',
  `status` varchar(50) NOT NULL DEFAULT 'Stopped' COMMENT 'Consumer Status',
  PRIMARY KEY (`entity_id`),
  UNIQUE KEY `RABBITMQ_CONSUMER_ACTIVITY_CONSUMER_NAME` (`consumer_name`),
  KEY `RABBITMQ_CONSUMER_ACTIVITY_STATUS` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='RabbitMQ Consumer Activity';
```

## 2. Информационная модель документооборота (DFD)

### 2.1 Диаграмма потоков данных (DFD)

![Диаграмма DFD](./images/dfd_diagram.png)

**Описание диаграммы DFD:**

Диаграмма потоков данных отображает движение информации в системе мониторинга Magento 2:

1. **Внешние сущности:**
   - Администратор системы
   - Разработчик
   - Сервис Telegram
   - Системный планировщик (Cron)
   - Система управления очередями (RabbitMQ)

2. **Процессы:**
   - **Мониторинг Cron-задач**
     - Сбор информации о Cron-задачах
     - Анализ выполнения задач
     - Определение проблемных задач
   - **Мониторинг RabbitMQ**
     - Сбор информации о консьюмерах
     - Анализ активности консьюмеров
     - Определение проблемных очередей
   - **Система уведомлений**
     - Формирование уведомлений
     - Отправка уведомлений
     - Логирование уведомлений
   - **Административный интерфейс**
     - Отображение статистики
     - Настройка параметров мониторинга
     - Управление уведомлениями

3. **Хранилища данных:**
   - **D1: lachestry_job_codes_info** - информация о Cron-задачах
   - **D2: lachestry_telegram_chats** - информация о Telegram-чатах
   - **D3: rabbitmq_consumer_activity** - информация о консьюмерах RabbitMQ
   - **D4: notification_log** - журнал уведомлений
   - **D5: core_config_data** - конфигурация системы

4. **Потоки данных:**
   - Информация о статусе Cron-задач
   - Информация о состоянии очередей
   - Уведомления о проблемах
   - Команды управления
   - Настройки мониторинга
   - Отчеты о состоянии системы

## 3. Объектно-ориентированный анализ и проектирование (UML)

### 3.1 Диаграмма вариантов использования (UseCase diagram)

![Диаграмма вариантов использования](./images/usecase_diagram.png)

**Описание диаграммы вариантов использования:**

1. **Акторы:**
   - **Администратор системы** - пользователь с полными правами доступа
   - **Разработчик** - пользователь с правами на просмотр и ограниченное управление
   - **Менеджер** - пользователь с правами только на просмотр
   - **Система уведомлений** - подсистема, отправляющая уведомления
   - **Планировщик Cron** - подсистема, управляющая выполнением задач
   - **RabbitMQ** - подсистема обработки очередей сообщений

2. **Варианты использования:**
   - **Управление мониторингом Cron-задач**
     - Просмотр списка Cron-задач
     - Просмотр детальной информации о задаче
     - Настройка параметров мониторинга
     - Ручной запуск Cron-задачи
   - **Управление мониторингом RabbitMQ**
     - Просмотр списка консьюмеров
     - Просмотр статистики очередей
     - Перезапуск консьюмера
   - **Управление уведомлениями**
     - Настройка правил уведомлений
     - Настройка каналов уведомлений
     - Просмотр журнала уведомлений
   - **Интеграция с Telegram**
     - Подключение Telegram-бота
     - Управление подписками на уведомления
     - Получение уведомлений в Telegram
   - **Просмотр отчетов и статистики**
     - Просмотр сводной информации
     - Просмотр графиков активности
     - Экспорт отчетов

### 3.2 Описание контрольного варианта использования

**Вариант использования:** Обработка уведомления о "застрявшей" Cron-задаче

**Основной сценарий:**
1. Система мониторинга обнаруживает, что Cron-задача не завершилась в ожидаемое время
2. Система проверяет наличие процесса, соответствующего задаче
3. Система определяет, что задача "застряла"
4. Система создает уведомление с критическим приоритетом
5. Система отправляет уведомление в настроенные каналы (Telegram)
6. Администратор получает уведомление в Telegram
7. Администратор переходит в административную панель Magento
8. Администратор просматривает детальную информацию о задаче
9. Администратор принимает решение о перезапуске задачи
10. Администратор выполняет перезапуск задачи через интерфейс
11. Система завершает проблемный процесс и инициирует новый запуск задачи
12. Система мониторинга фиксирует успешный перезапуск задачи
13. Система отправляет уведомление об успешном решении проблемы

**Альтернативные сценарии:**
* A4: Если задача не критична, уведомление создается с предупреждающим приоритетом
* A9: Если проблему нельзя решить перезапуском, администратор эскалирует проблему разработчику
* A11: Если перезапуск не решает проблему, система отправляет повторное уведомление с информацией о неудаче

**Предусловия:**
* Система мониторинга активна и настроена
* Интеграция с Telegram настроена
* Администратор имеет доступ к Telegram и административной панели Magento

**Постусловия:**
* Проблема с "застрявшей" Cron-задачей устранена
* В системе зафиксирована информация об инциденте и его решении

### 3.3 Диаграмма деятельности (Activity diagram)

![Диаграмма деятельности](./images/activity_diagram.png)

**Описание диаграммы деятельности:**

Диаграмма деятельности отображает процесс обнаружения и устранения проблемы с Cron-задачей:

1. **Начальное состояние** - запуск процесса мониторинга

2. **Действия:**
   - Сбор информации о Cron-задачах
   - Анализ статуса каждой задачи
   - Проверка времени выполнения
   - Определение "застрявших" задач
   - Формирование уведомления
   - Отправка уведомления в Telegram
   - Получение уведомления администратором
   - Анализ проблемы
   - Принятие решения о способе устранения
   - Перезапуск задачи
   - Проверка результата перезапуска
   - Закрытие инцидента

3. **Решения:**
   - Есть ли "застрявшие" задачи?
   - Является ли задача критичной?
   - Можно ли решить проблему перезапуском?
   - Успешно ли выполнен перезапуск?

4. **Конечное состояние** - завершение процесса обработки инцидента

### 3.4 Диаграмма последовательности (Sequence diagram)

![Диаграмма последовательности](./images/sequence_diagram.png)

**Описание диаграммы последовательности:**

Диаграмма последовательности отображает взаимодействие компонентов системы при обработке "застрявшей" Cron-задачи:

1. **Объекты:**
   - **:CronMonitor** - компонент мониторинга Cron-задач
   - **:Database** - база данных Magento
   - **:NotificationManager** - менеджер уведомлений
   - **:TelegramIntegration** - компонент интеграции с Telegram
   - **:AdminUser** - администратор системы
   - **:CronManager** - компонент управления Cron-задачами

2. **Последовательность сообщений:**
   - CronMonitor → Database: Запрос статуса задач
   - Database → CronMonitor: Информация о задачах
   - CronMonitor: Анализ статуса задач
   - CronMonitor → NotificationManager: Создание уведомления о проблеме
   - NotificationManager → TelegramIntegration: Отправка уведомления
   - TelegramIntegration → AdminUser: Доставка уведомления
   - AdminUser → CronManager: Запрос перезапуска задачи
   - CronManager → Database: Обновление статуса задачи
   - CronManager: Перезапуск задачи
   - CronManager → NotificationManager: Создание уведомления о результате
   - NotificationManager → TelegramIntegration: Отправка уведомления о результате
   - TelegramIntegration → AdminUser: Доставка уведомления о результате

### 3.5 Диаграмма классов (Class diagram)

![Диаграмма классов](./images/class_diagram.png)

**Описание диаграммы классов:**

Диаграмма классов отображает структуру классов системы мониторинга Magento 2:

1. **Модуль Lachestry_Cron:**
   - **Класс CronJobRepository**
     - Атрибуты: resourceConnection, cronJobFactory
     - Методы: getById(), getList(), save(), delete()
   - **Класс CronJob**
     - Атрибуты: id, jobCodeName, schedule, module, configPath, group
     - Методы: getId(), getJobCodeName(), getSchedule(), getModule(), getConfigPath(), getGroup()
   - **Интерфейс CronJobRepositoryInterface**
     - Методы: getById(), getList(), save(), delete()

2. **Модуль Lachestry_RabbitMQMonitor:**
   - **Класс ConsumerActivityRepository**
     - Атрибуты: resourceConnection, consumerActivityFactory
     - Методы: getById(), getList(), save(), delete()
   - **Класс ConsumerActivity**
     - Атрибуты: entityId, consumerName, pid, lastActivity, status
     - Методы: getEntityId(), getConsumerName(), getPid(), getLastActivity(), getStatus()
   - **Класс ConsumerMonitor**
     - Атрибуты: consumerActivityRepository
     - Методы: checkConsumerActivity(), updateStatus()

3. **Модуль Lachestry_Telegram:**
   - **Класс TelegramChatRepository**
     - Атрибуты: resourceConnection, telegramChatFactory
     - Методы: getById(), getByChatId(), getList(), save(), delete()
   - **Класс TelegramChat**
     - Атрибуты: id, chatId, chatName, userName, createdAt, telegramUpdatedAt, isActive
     - Методы: getId(), getChatId(), getChatName(), getUserName(), getCreatedAt(), getIsActive()
   - **Класс TelegramClient**
     - Атрибуты: apiToken, baseUrl
     - Методы: sendMessage(), getUpdates()

4. **Модуль Lachestry_Notifier:**
   - **Класс NotificationManager**
     - Атрибуты: telegramClient, notificationRepository
     - Методы: notify(), createNotification(), sendNotification()
   - **Интерфейс NotificationChannelInterface**
     - Методы: send()
   - **Класс TelegramNotificationChannel**
     - Атрибуты: telegramClient, telegramChatRepository
     - Методы: send()

### 3.6 Диаграмма состояний и переходов (StateChart diagram)

![Диаграмма состояний](./images/statechart_diagram.png)

**Описание диаграммы состояний:**

Диаграмма состояний отображает возможные состояния Cron-задачи в системе мониторинга:

1. **Состояния:**
   - **Запланировано** - задача запланирована, но еще не запущена
   - **Выполняется** - задача находится в процессе выполнения
   - **Завершено успешно** - задача успешно завершена
   - **Завершено с ошибкой** - задача завершена с ошибкой
   - **"Застряла"** - задача выполняется дольше ожидаемого времени
   - **Пропущена** - задача не была выполнена в запланированное время
   - **Остановлена** - задача была принудительно остановлена

2. **Переходы:**
   - Запланировано → Выполняется: Начало выполнения задачи
   - Выполняется → Завершено успешно: Успешное завершение
   - Выполняется → Завершено с ошибкой: Возникновение ошибки
   - Выполняется → "Застряла": Превышение лимита времени
   - "Застряла" → Остановлена: Принудительная остановка
   - "Застряла" → Выполняется: Продолжение выполнения
   - Запланировано → Пропущена: Пропуск запланированного времени
   - Любое состояние → Запланировано: Перепланирование задачи

3. **События:**
   - Запуск планировщика
   - Истечение таймаута
   - Возникновение ошибки
   - Действие администратора
   - Перезапуск системы

### 3.7 Диаграмма компонентов (Component diagram)

![Диаграмма компонентов](./images/component_diagram.png)

**Описание диаграммы компонентов:**

Диаграмма компонентов отображает структурные компоненты системы мониторинга Magento 2:

1. **Основные компоненты:**
   - **Lachestry_Base** - базовый компонент с общей функциональностью
   - **Lachestry_Configuration** - компонент управления конфигурацией
   - **Lachestry_Cron** - компонент мониторинга Cron-задач
   - **Lachestry_CronMonitoring** - компонент отображения информации о Cron-задачах
   - **Lachestry_RabbitMQMonitor** - компонент мониторинга RabbitMQ
   - **Lachestry_Telegram** - компонент интеграции с Telegram
   - **Lachestry_Notifier** - компонент системы уведомлений

2. **Зависимости между компонентами:**
   - Lachestry_Cron зависит от Lachestry_Base
   - Lachestry_CronMonitoring зависит от Lachestry_Cron
   - Lachestry_RabbitMQMonitor зависит от Lachestry_Base
   - Lachestry_Telegram зависит от Lachestry_Base
   - Lachestry_Notifier зависит от Lachestry_Telegram, Lachestry_Cron, Lachestry_RabbitMQMonitor
   - Все компоненты зависят от Lachestry_Configuration

3. **Интерфейсы:**
   - **CronJobRepositoryInterface** - интерфейс для работы с Cron-задачами
   - **ConsumerActivityRepositoryInterface** - интерфейс для работы с консьюмерами RabbitMQ
   - **TelegramClientInterface** - интерфейс для интеграции с Telegram
   - **NotificationChannelInterface** - интерфейс для каналов уведомлений

### 3.8 Диаграмма развертывания (Deployment diagram)

![Диаграмма развертывания](./images/deployment_diagram.png)

**Описание диаграммы развертывания:**

Диаграмма развертывания отображает физическое размещение компонентов системы:

1. **Узлы:**
   - **Веб-сервер**
     - Операционная система: Linux
     - Веб-сервер: Nginx
     - PHP-FPM
     - Magento 2
     - Модули мониторинга (Lachestry)
   - **Сервер базы данных**
     - Операционная система: Linux
     - MySQL 5.7
     - База данных Magento
     - Таблицы модулей мониторинга
   - **Сервер RabbitMQ**
     - Операционная система: Linux
     - RabbitMQ 3.x
     - Очереди Magento
   - **Сервер Elasticsearch**
     - Операционная система: Linux
     - Elasticsearch 7.x
     - Индексы Magento
   - **Клиентские устройства**
     - Браузер (для доступа к административной панели)
     - Telegram-клиент (для получения уведомлений)
   - **Сервер Telegram**
     - Telegram API

2. **Соединения:**
   - Веб-сервер ↔ Сервер базы данных: TCP/IP (MySQL protocol)
   - Веб-сервер ↔ Сервер RabbitMQ: TCP/IP (AMQP)
   - Веб-сервер ↔ Сервер Elasticsearch: TCP/IP (HTTP/REST)
   - Веб-сервер ↔ Сервер Telegram: HTTPS
   - Клиентские устройства ↔ Веб-сервер: HTTPS
   - Клиентские устройства ↔ Сервер Telegram: HTTPS

3. **Артефакты:**
   - **Магазин Magento** - основное приложение
   - **Модули мониторинга** - набор PHP-модулей
   - **База данных Magento** - данные магазина и мониторинга
   - **Очереди сообщений** - очереди RabbitMQ для обработки данных
   - **Поисковые индексы** - индексы Elasticsearch для поиска
   - **Telegram-бот** - бот для отправки уведомлений 